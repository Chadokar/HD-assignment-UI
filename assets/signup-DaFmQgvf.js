import{a as x,c as p,k as d,j as e,r as g,u as S,m as N,L as O}from"./index-NU_4X-3C.js";import{u as P,g as k,c as T}from"./google-DOP0tsUh.js";import{S as n,I as m,B as h,L as C}from"./types-Dc_A43y2.js";const A=async(a,l,t,c,s)=>{var r,o;s(!0);try{const i=await x.post(a,l,p());c(i.data.token),d.success("OTP sent successfully"),t(n.OTP)}catch(i){return d.error(((o=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:o.message)||(i==null?void 0:i.message)||"Failed to send OTP"),t(n.DETAILS),i}finally{s(!1)}},D=async(a,l,t,c,s)=>{s(!0);try{const{data:r}=await x.post(a,l,p());return t(n.PASSWORD),d.success("OTP verified successfully"),c(r.token),r}catch(r){t(n.OTP),d.error((r==null?void 0:r.message)||"Failed to verify OTP")}finally{s(!1)}},E=async(a,l,t,c)=>{c(!0);try{const s=await x.post(a,l,p());d.success("Password set successfully"),localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user)),t("/")}catch(s){d.error((s==null?void 0:s.message)||"Failed to set password")}finally{c(!1)}},I=async(a,l,t,c,s,r,o)=>{switch(l){case n.DETAILS:A("signup",{email:a.email,name:a.name,dob:a.dateOfBirth},t,s,r);break;case n.OTP:D("signup-verify",{otp:Number(a.otp),token:c},t,s,r);break;case n.PASSWORD:await E("signin",{password:a.password,token:c},o,r);break;default:throw new Error("Invalid step")}},q="data:image/svg+xml,%3csvg%20width='21'%20height='24'%20viewBox='0%200%2021%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M19.3094%2010.0516H1.15894M14.2676%201.98474V6.01817M6.20072%201.98474V6.01817M5.99905%2022.1519H14.4692C16.1634%2022.1519%2017.0105%2022.1519%2017.6576%2021.8222C18.2268%2021.5321%2018.6896%2021.0694%2018.9796%2020.5002C19.3094%2019.8531%2019.3094%2019.006%2019.3094%2017.3118V8.84157C19.3094%207.14737%2019.3094%206.30027%2018.9796%205.65317C18.6896%205.08397%2018.2268%204.62119%2017.6576%204.33117C17.0105%204.00145%2016.1634%204.00146%2014.4692%204.00146H5.99905C4.30485%204.00146%203.45775%204.00145%202.81065%204.33117C2.24145%204.62119%201.77867%205.08397%201.48865%205.65317C1.15894%206.30027%201.15894%207.14737%201.15894%208.84157V17.3118C1.15894%2019.006%201.15894%2019.8531%201.48865%2020.5002C1.77867%2021.0694%202.24145%2021.5321%202.81065%2021.8222C3.45775%2022.1519%204.30485%2022.1519%205.99905%2022.1519Z'%20stroke='%23232323'%20stroke-width='2.01671'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",F=(a,{register:l,errors:t,getValues:c})=>{var s,r,o,i,u;switch(a){case n.DETAILS:return e.jsxs(e.Fragment,{children:[e.jsx(m,{id:"name",label:"Full Name",...l("name",{required:"Name is required"}),error:(s=t.name)==null?void 0:s.message}),e.jsx(m,{id:"dateOfBirth",type:"text",calendarIcon:q,label:"Date of Birth",...l("dateOfBirth",{required:"Date of birth is required"}),error:(r=t.dateOfBirth)==null?void 0:r.message}),e.jsx(m,{id:"email",type:"email",label:"Email",...l("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),error:(o=t.email)==null?void 0:o.message})]});case n.OTP:return e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["We've sent a verification code to ",c("email")]}),e.jsx(m,{id:"otp",label:"Enter OTP",...l("otp",{required:"OTP is required",pattern:{value:/^[0-9]{6}$/,message:"Invalid OTP format"}}),error:(i=t.otp)==null?void 0:i.message})]});case n.PASSWORD:return e.jsx(m,{id:"password",type:"password",label:"Create Password",...l("password",{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"}}),error:(u=t.password)==null?void 0:u.message});default:return null}};function R(){const[a,l]=g.useState(n.DETAILS),[t,c]=g.useState(!1),s=S(),[r,o]=g.useState(""),{register:i,handleSubmit:u,formState:{errors:w},getValues:y,reset:j}=P();async function v(f){await I(f,a,l,r,o,c,s),j()}async function b(){x.get("google/redirect").then(f=>{window.location.href=f.data.url})}return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx("div",{className:"flex w-full items-center justify-center p-4 lg:w-2/5",children:e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md space-y-10",children:[e.jsxs("div",{className:"flex flex-col gap-2 lg:items-start items-center",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Sign up"}),e.jsx("p",{className:"text-sm text-secondary dark:text-gray-400",children:"Sign up to enjoy the feature of HD"})]}),e.jsxs("form",{onSubmit:u(v),className:"space-y-6 gap-4",children:[F(a,{register:i,errors:w,getValues:y}),e.jsx(h,{type:"submit",className:"w-full",isLoading:t,children:t?e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}):a===n.DETAILS?"Continue":a===n.OTP?"Verify OTP":"Complete Sign Up"})]}),a===n.DETAILS&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-aclline"})}),e.jsx("div",{className:"relative flex justify-center text-[1rem]",children:e.jsx("span",{className:"bg-white px-2 text-aclline2 text-muted-foreground dark:bg-gray-900",children:"or"})})]}),e.jsxs(h,{type:"button",variant:"outline",className:"w-full",onClick:()=>{b()},children:["Continue with Google",e.jsx("img",{src:k,alt:"Google",className:"ml-2 h-6 w-6"})]})]}),e.jsxs("p",{className:"text-center text-[14px] text-gray-600 dark:text-gray-400",children:["Already have an account??","   ",e.jsx(O,{to:"/signin",className:"font-semibold text-blue-500 underline",children:"Sign in"})]})]})}),e.jsx("div",{className:"hidden lg:block lg:w-3/5 h-[calc(100vh+48px)] absolute top-2 right-2 font-semibold",children:e.jsx("div",{className:"relative h-full w-full",children:e.jsx("img",{src:T,alt:"Abstract waves",className:"h-full w-full object-cover border-0 rounded-3xl"})})})]})}export{R as default};
