import{S as c}from"./types-BatVEiCz.js";import{a as i,k as n}from"./index-BTgyP7uX.js";const u=async(s,r,a,o)=>{a(!0);try{const e=await i.post(s,r);return localStorage.setItem("token",e.data.token),localStorage.setItem("user",JSON.stringify(e.data.user)),n.success("Signed in successfully"),o("/"),e.data}catch(e){return n.error((e==null?void 0:e.message)||"Failed to sign in"),e}finally{a(!1)}},S=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},m=async(s,r,a,o,e)=>{e(!0);try{const t=await i.post(s,r);return a(c.OTP),o(t.data.token),n.success("OTP sent successfully"),t.data}catch(t){return n.error((t==null?void 0:t.message)||"Failed to send OTP"),t}finally{e(!1)}},f=async(s,r,a,o)=>{a(!0);try{const e=await i.post(s,r);return localStorage.setItem("token",e.data.token),localStorage.setItem("user",JSON.stringify(e.data.user)),n.success("OTP verified successfully"),o("/"),e.data}catch(e){return n.error((e==null?void 0:e.message)||"Failed to verify OTP"),e}finally{a(!1)}},g=async(s,r,a,o,e,t,l)=>{switch(r){case c.DETAILS:m("signin-otp",{email:s.email},a,e,t);break;case c.OTP:f("verify-otp",{otp:Number(s.otp),token:o},t,l);break;case c.PASSWORD:await u("signin",{email:s.email,password:s.password},t,l);break;default:throw new Error("Invalid step")}};export{g as o,S as s};
